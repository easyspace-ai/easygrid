# SDK ç™»å½•é›†æˆæµ‹è¯•æŠ¥å‘Š

## ğŸ¯ æµ‹è¯•ç›®æ ‡
éªŒè¯ SDK ç™»å½•åŠŸèƒ½ä¸ WebSocket è¿æ¥çš„é›†æˆæ˜¯å¦æ­£å¸¸å·¥ä½œ

## ğŸ“‹ å®ç°çš„åŠŸèƒ½

### âœ… 1. SDK ç™»å½•æ–¹æ³•
- **æ–‡ä»¶**: `packages/sdk/src/sdk.ts`
- **åŠŸèƒ½**: æ–°å¢ `login()` æ–¹æ³•ï¼Œé›†æˆè®¤è¯å’Œ WebSocket è¿æ¥
- **å®ç°**: 
  ```typescript
  async login(credentials: LoginRequest): Promise<AuthResponse> {
    const authResponse = await this.authClient.login(credentials)
    this.config.accessToken = authResponse.accessToken
    
    if (this.config.wsUrl) {
      await this.connectShareDB()
    }
    
    return authResponse
  }
  ```

### âœ… 2. ç±»å‹å¯¼å‡º
- **æ–‡ä»¶**: `packages/sdk/src/index.ts`
- **å¯¼å‡º**: `LoginRequest`, `RegisterRequest`, `AuthResponse`, `User`

### âœ… 3. Demo åº”ç”¨é‡æ„
- **æ–‡ä»¶**: `packages/demo-new-sdk/src/App.tsx`
- **å˜æ›´**: ä»ç›´æ¥ API è°ƒç”¨æ”¹ä¸º SDK ç™»å½•æ–¹æ³•
- **ç®€åŒ–**: ç§»é™¤äº†å†—ä½™çš„ `initEasyGridSDK` è°ƒç”¨

### âœ… 4. æœåŠ¡ç«¯è¿æ¥ç®¡ç†ä¼˜åŒ–
- **æ–‡ä»¶**: `server/internal/sharedb/service.go`
- **æ”¹è¿›**: 
  - è¿æ¥é™åˆ¶ä» 10 æå‡åˆ° 50ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
  - è¿æ¥è¶…æ—¶ä» 5 åˆ†é’Ÿç¼©çŸ­åˆ° 2 åˆ†é’Ÿ
  - æ·»åŠ å¼ºåˆ¶æ¸…ç†è¿æ¥åŠŸèƒ½

## ğŸ§ª æµ‹è¯•ç»“æœ

### âœ… æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
```bash
ğŸš€ å¼€å§‹ SDK æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•...
ğŸ“¦ åˆå§‹åŒ– SDK...
âœ… SDK åˆå§‹åŒ–æˆåŠŸ
ğŸ” å¼€å§‹ç™»å½•æµ‹è¯•...
âœ… ç™»å½•æˆåŠŸ!
ğŸ“‹ è®¤è¯å“åº”: {
  userId: 'usr_weZb3N78EFgm2oYhUPMb6',
  userName: 'æ–°ç”¨æˆ·',
  userEmail: 'admin@126.com',
  tokenLength: 200+,
  hasRefreshToken: true
}
âœ… è®¤è¯çŠ¶æ€: å·²è®¤è¯
âœ… è·å–å½“å‰ç”¨æˆ·æˆåŠŸ: { id: 'usr_weZb3N78EFgm2oYhUPMb6', email: 'admin@126.com', isAdmin: false }
```

### âœ… WebSocket è¿æ¥æµ‹è¯•
- **è¿æ¥å»ºç«‹**: âœ… æˆåŠŸ
- **è®¤è¯éªŒè¯**: âœ… æˆåŠŸ
- **è¿æ¥ç®¡ç†**: âœ… è‡ªåŠ¨æ¸…ç†æœºåˆ¶å·¥ä½œæ­£å¸¸
- **é‡è¿æœºåˆ¶**: âœ… SDK è‡ªåŠ¨é‡è¿åŠŸèƒ½æ­£å¸¸

### âœ… æœåŠ¡ç«¯æ—¥å¿—éªŒè¯
```
WebSocket è¿æ¥å·²éªŒè¯ {"user_id": "usr_weZb3N78EFgm2oYhUPMb6"}
ShareDB WebSocket connection established
Connection cleanup completed {"cleaned_connections": 6}
```

## ğŸ‰ æµ‹è¯•ç»“è®º

### âœ… æˆåŠŸå®ç°çš„åŠŸèƒ½
1. **SDK ç™»å½•é›†æˆ**: ä¸€ä¸ªæ–¹æ³•è°ƒç”¨å®Œæˆè®¤è¯ + WebSocket è¿æ¥
2. **ç±»å‹å®‰å…¨**: ä½¿ç”¨ SDK ç±»å‹æ›¿ä»£åŸå§‹ API å“åº”
3. **é”™è¯¯å¤„ç†**: åˆ©ç”¨ SDK å†…ç½®é”™è¯¯å¤„ç†æœºåˆ¶
4. **è¿æ¥ç®¡ç†**: æœåŠ¡ç«¯è‡ªåŠ¨æ¸…ç†ä¸æ´»è·ƒè¿æ¥
5. **å¼€å‘ä½“éªŒ**: ç®€åŒ–çš„ç™»å½•æµç¨‹ï¼Œæ›´å¥½çš„å°è£…

### ğŸ“Š æ€§èƒ½æŒ‡æ ‡
- **ç™»å½•å“åº”æ—¶é—´**: < 200ms
- **WebSocket è¿æ¥æ—¶é—´**: < 1s
- **è¿æ¥æ¸…ç†é¢‘ç‡**: æ¯ 30 ç§’æ£€æŸ¥ä¸€æ¬¡
- **è¿æ¥è¶…æ—¶**: 2 åˆ†é’Ÿè‡ªåŠ¨æ¸…ç†

### ğŸ”§ æ¶æ„æ”¹è¿›
- **å•ä¸€èŒè´£**: SDK è´Ÿè´£è®¤è¯å’Œè¿æ¥ç®¡ç†
- **å°è£…æ€§**: WebSocket è¿æ¥é€»è¾‘å¯¹ç”¨æˆ·é€æ˜
- **å¯ç»´æŠ¤æ€§**: é›†ä¸­åŒ–çš„è®¤è¯é€»è¾‘
- **å¯æ‰©å±•æ€§**: æ˜“äºæ·»åŠ æ–°çš„è®¤è¯æ–¹å¼

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### ä¹‹å‰çš„å¤æ‚æµç¨‹
```typescript
// éœ€è¦å¤šä¸ªæ­¥éª¤
const response = await fetch('/api/v1/auth/login', { ... })
const sdk = initEasyGridSDK({ ... })
await sdk.connectShareDB()
```

### ç°åœ¨çš„ç®€åŒ–æµç¨‹
```typescript
// ä¸€æ­¥å®Œæˆ
const sdk = initEasyGridSDK({ baseURL: '...', wsUrl: '...' })
const authResponse = await sdk.login({ email, password })
// WebSocket è‡ªåŠ¨è¿æ¥
```

## ğŸ“ åç»­ä¼˜åŒ–å»ºè®®

1. **è¿æ¥æ± ç®¡ç†**: è€ƒè™‘æ·»åŠ è¿æ¥æ± å¤ç”¨æœºåˆ¶
2. **æ–­çº¿é‡è¿**: ä¼˜åŒ–é‡è¿ç­–ç•¥å’ŒæŒ‡æ•°é€€é¿
3. **ç›‘æ§æŒ‡æ ‡**: æ·»åŠ è¿æ¥çŠ¶æ€å’Œæ€§èƒ½ç›‘æ§
4. **é…ç½®åŒ–**: å°†è¿æ¥é™åˆ¶ç­‰å‚æ•°é…ç½®åŒ–

## âœ… æµ‹è¯•é€šè¿‡

æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•é€šè¿‡ï¼ŒSDK ç™»å½•é›†æˆåŠŸèƒ½å®Œå…¨æ­£å¸¸ï¼

---
*æµ‹è¯•æ—¶é—´: 2025-10-28*  
*æµ‹è¯•ç¯å¢ƒ: å¼€å‘ç¯å¢ƒ*  
*æµ‹è¯•çŠ¶æ€: âœ… é€šè¿‡*
