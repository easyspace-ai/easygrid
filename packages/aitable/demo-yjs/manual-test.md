# ShareDB 实时同步手动测试指南

## 系统状态检查

### 1. 后端服务状态
```bash
# 检查后端服务
curl -X POST http://localhost:2345/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@126.com","password":"Pmker123"}'

# 检查 ShareDB 服务
curl -X GET http://localhost:2345/api/v1/sharedb/stats \
  -H "Authorization: Bearer YOUR_TOKEN"
```

### 2. 前端服务状态
```bash
# 检查前端服务
curl -s http://localhost:3032 | head -5
```

## 手动测试步骤

### 步骤1: 单用户测试
1. 打开浏览器访问 `http://localhost:3032`
2. 使用账号登录：
   - 邮箱: `admin@126.com`
   - 密码: `Pmker123`
3. 检查登录成功，显示"欢迎, 新用户 (admin@126.com)"
4. 检查 ShareDB 连接状态指示器（绿色圆点表示连接正常）
5. 等待表格数据加载完成
6. 尝试编辑一个单元格：
   - 双击单元格进入编辑模式
   - 输入测试数据
   - 按 Enter 提交

### 步骤2: 多用户实时同步测试
1. 打开两个浏览器窗口/标签页
2. 在两个窗口中分别登录（使用相同账号）
3. 等待两个窗口都显示表格数据
4. 在窗口1中编辑一个单元格
5. 观察窗口2是否在1-2秒内自动更新
6. 在窗口2中编辑另一个单元格
7. 观察窗口1是否自动更新

### 步骤3: 并发编辑测试
1. 在两个窗口中同时编辑同一单元格
2. 观察冲突处理机制
3. 验证最终数据一致性

## 预期结果

### ✅ 成功指标
- 登录成功，显示用户信息
- ShareDB 连接状态为绿色（已连接）
- 表格数据正常加载和显示
- 单元格编辑功能正常
- 多用户实时同步工作正常
- 编辑操作在1-2秒内同步到其他用户

### ❌ 失败指标
- 登录失败或显示错误信息
- ShareDB 连接状态为红色（离线）
- 表格数据加载失败
- 单元格编辑无响应
- 多用户同步延迟超过5秒
- 编辑操作不同步

## 故障排除

### 问题1: 登录失败
- 检查后端服务是否运行在 `http://localhost:2345`
- 检查数据库连接是否正常
- 查看后端日志

### 问题2: ShareDB 连接失败
- 检查后端 ShareDB 服务是否启用
- 检查 WebSocket 连接是否正常
- 查看浏览器控制台错误信息

### 问题3: 表格数据加载失败
- 检查网络请求是否成功
- 检查 API 响应是否正常
- 查看浏览器控制台错误信息

### 问题4: 实时同步不工作
- 检查 ShareDB WebSocket 连接
- 检查后端 ShareDB 服务状态
- 查看网络请求和 WebSocket 消息

## 测试报告模板

```
测试时间: [日期时间]
测试人员: [姓名]
测试环境: [环境描述]

### 系统状态
- 后端服务: ✅/❌
- 前端服务: ✅/❌
- ShareDB 服务: ✅/❌

### 功能测试
- 用户登录: ✅/❌
- 数据加载: ✅/❌
- 单元格编辑: ✅/❌
- 实时同步: ✅/❌

### 问题记录
[记录发现的问题和解决方案]

### 结论
[测试结果总结和建议]
```

## 下一步

如果手动测试成功，可以：
1. 创建自动化测试脚本
2. 进行性能测试
3. 进行压力测试
4. 部署到生产环境

如果测试失败，需要：
1. 检查系统配置
2. 修复发现的问题
3. 重新测试
